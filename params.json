{"name":"Pockethotline","tagline":"Community Powered Hotlines","body":"# What\r\nPockethotline is a rails app that allows you to setup a \"distributed hotline\". This allows you to have a hotline number that is published and operators signup with their personal numbers. When someone calls the main number the operators will be called (depending on their on-call status) and connected to the main caller.\r\n\r\nIt was originally conceived as a business by Scott Magee and Chap Ambrose at the Austin Center for Design in the winter of 2011.\r\n\r\nThe software was open-sourced January 2014.\r\n\r\n# How much does it cost to run a hotline?\r\n\r\n#### Hosting Costs\r\nThe minimum hosting costs are about $35 a month. This is because a background worker dyno is required. (Assuming you're using [Heroku](http://heroku.com) for hosting).\r\n\r\n#### Phone Costs\r\n[Twilio](http://twilio.com) phone numbers cost $1/month for local numbers and $2/month for toll-free.\r\n\r\nTwilio charges you by minutes used, $0.03/minute for local and $0.05/minute for toll-free. \r\n\r\n*Twilio's published rates are $0.01 / $0.03 but that is only for the incoming call, you also have to add another $0.02 to each call because of the outgoing connection to the operators.*\r\n\r\n# Basic Setup\r\n\r\n##1. Setup accounts on:\r\n* [Twilio.com](http://twilio.com)\r\n* [Heroku.com](http://heroku.com) (or other rails capable host)\r\n\r\n##2. Get a phone number on Twilio\r\nStart with the free trial number or purchase another toll-free or local number.\r\n\r\n##3. Take note of your phone number and API credentials AccountSID and AuthToken \r\nFind them under \"Account Settings\"\r\n\r\n##4. Clone the repository  \r\n```$ git clone git@github.com:chap/pockethotline.git```\r\n\r\n##5. Edit config file at ```/config/initializers/hotline.rb``` \r\nYou must edit values for:\r\n\r\n* config.x.hotline.name\r\n* config.x.hotline.domain\r\n* config.x.hotline.organizer\r\n* config.x.hotline.organizer_email \r\n* config.x.hotline.number\r\n\r\n##6. Save changes  \r\n```$ git commit config/initializers/hotline.rb -m \"updated config\"```\r\n\r\n##7. Create an app on heroku  \r\n```$ heroku create myhotline-name```\r\n\r\n##8. Enable Sendgrid add-on for sending email\r\n```$ heroku addons:add sendgrid```\r\n  \r\nAny SMTP provider should work. If you don't use Sendgrid, manually update settings at ```config/initializers/smtp_settings.rb```\r\n\r\n##9. Push application to heroku  \r\n```$ git push heroku master```\r\n\r\n##10. Create database tables  \r\n```$ heroku run rake db:schema:load```\r\n\r\n##11. Scale up worker dyno (required for background tasks)  \r\n```$ heroku ps:scale worker=1```\r\n\r\n##12. Add TWILIO_AUTH_TOKEN ENV variable to heroku config\r\nUse Twilio API credentials from step 3.\r\n```$ heroku config:set TWILIO_AUTH_TOKEN=XXXXXXXXXXXXXX```\r\n\r\n##13. Add SESSION_SECRET ENV variables to heroku config\r\nFirst run  \r\n```$ heroku run rake secret```\r\n\r\nCopy the output and use it here:  \r\n```$ heroku config:set SESSION_SECRET=XXXXXXXXXXXXXX```\r\n\r\n##14. Setup the on-call scheduler\r\n1. ```$ heroku addons:add scheduler```\r\n2. ```$ heroku addons:open scheduler```\r\n3. Click \"Add Job\"\r\n4. In the left-most field enter \"rake oncall_scheduler\"\r\n5. Change frequency to \"Hourly\"\r\n6. Set next run to \"XX:00\" (The XX will depend on the current time.)\r\n7. Click \"Save\"\r\n\r\n\r\n##15. Create yourself an account (edit these values)  \r\n```\r\n  $ heroku run rails console\r\n  $ u = User.new(\r\n    :name => 'my name', \r\n    :email => 'myemail@email.com', \r\n    :phone => '215-359-5228', \r\n    :password => 'setyourpasswordhere'\r\n    )\r\n    u.admin = true\r\n    u.on_call = true\r\n    u.save!\r\n```\r\n\r\n##16. Login to your account\r\n```$ heroku open```\r\n\r\n##17. Update Twilio with your app's domain\r\n* Click on 'Numbers' in the nav bar\r\n* Click on your phone number\r\n* Change the 'Voice Request URL' to ```https://myhotline-name.herokuapp.com/twilio/start```\r\n* Set request method to [POST]\r\n\r\n##18. Call the hotline and see if it's working!\r\n* Don't call from the same number that you added for yourself\r\n* If you're using your free demo Twilio account you'll hear a pre-roll message. That will go away when you upgrade your account.\r\n* Your call should be connected after the greeting message is used.\r\n* If calling via Gtalk fails to connect, try a real land or cell line.\r\n\r\n##19. Yeah!\r\n\r\n===\r\n\r\n#Advanced Setup of Hotline Supporters\r\n\r\n##1. Create an account on Stripe.com\r\n\r\n##2. Set Stripe publishable key in config\r\nUncomment (remove leading '#') and edit values in  ```/config/hotline.rb```\r\n\r\n* config.x.stripe.publishable_key\r\n\r\n##3. Add Stripe API key\r\n```$ heroku config:set STRIPE_SECRET_KEY=XXXXXXXXXXXXXX```\r\n\r\n##4. Save changes and deploy\r\n```$ git commit /config/initializers/hotline.rb -m \"add stripe details\"```\r\n```$ git push heroku```\r\n  \r\n##5. Visit suporters page\r\n\r\nhttps://.../supporters/new  \r\n\r\nStripe requires SSL to be enabled, if you're using your default heroku domain you will seemlessly piggy-back on the wildcard certificate at *.herokuapp.com.\r\n\r\nIf you want to use a different domain you may have to purchase and setup your own certificate. \r\n\r\n===\r\n\r\n#Advanced Allow Supporters to Upload Images\r\n\r\n##1. Add your S3 bucket name to /config/hotline.rb\r\n\r\n##2. Add S3 access_key_id and secret_access_key\r\n```$ heroku config:set S3_ACCESS_KEY_ID=XXXXXXXXXXXXXX S3_SECRET_ACCESS_KEY=XXXXXXXXXXXXXX```\r\n\r\n===\r\n\r\n#Forward unanswered calls, change recordings, Twitter integration, etc\r\n\r\nLook at all the options in /config/hotline.rb\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}